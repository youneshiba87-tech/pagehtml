<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport Industriel: Certifications ISO 9001 Alg√©rie (Plomberie/Chauffage)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f5f5f4; 
            color: #1c1917; 
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 100%; 
            height: 350px;
            max-height: 400px;
        }

        .nav-item.active {
            background-color: #e7e5e4;
            color: #ea580c; 
            border-left: 4px solid #ea580c;
        }

        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Custom Scrollbar for Table */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #d6d3d1; 
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #a8a29e; 
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals (Stone/Warm Grey) with Construction Orange Accents -->
    <!-- Application Structure Plan: Dashboard layout. Sidebar for main navigation (Vue d'ensemble, Analyse de March√©, Annuaire Entreprises, Facteurs Strat√©giques). Top stats bar. Central content area updates dynamically. Designed to allow high-level trend analysis first, then drill-down into specific company data. -->
    <!-- Visualization & Content Choices: 
         1. Overview: Key Metrics (Cards) -> Immediate context.
         2. Trends: Line Chart -> Visualize growth over 5 years. 
         3. Sectors: Doughnut Chart -> Show market segmentation.
         4. Geography: Bar Chart -> Regional concentration analysis.
         5. Directory: Interactive Table -> Search/Filter specific entities.
         6. Insights: Grid of text cards -> Qualitative analysis.
         NO SVG/Mermaid used. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="flex h-screen overflow-hidden">

    <!-- Sidebar -->
    <aside class="w-64 bg-white border-r border-stone-200 hidden md:flex flex-col z-10">
        <div class="p-6 border-b border-stone-100">
            <h1 class="text-xl font-bold text-stone-800">Prophex<span class="text-red-600">DZ</span></h1>
            <p class="text-xs text-stone-500 mt-1">Rapport ISO 9001:2015</p>
            <p class="text-xs text-stone-400">Secteur: Fluides & Thermique</p>
        </div>
        <nav class="flex-1 overflow-y-auto py-4">
            <ul>
                <li>
                    <button onclick="switchTab('overview')" id="nav-overview" class="nav-item active w-full text-left px-6 py-3 text-sm font-medium text-stone-600 hover:bg-stone-50 transition-colors flex items-center">
                        <span>üìä Vue d'ensemble</span>
                    </button>
                </li>
                <li>
                    <button onclick="switchTab('companies')" id="nav-companies" class="nav-item w-full text-left px-6 py-3 text-sm font-medium text-stone-600 hover:bg-stone-50 transition-colors flex items-center">
                        <span>üè¢ Annuaire Entreprises</span>
                    </button>
                </li>
                <li>
                    <button onclick="switchTab('insights')" id="nav-insights" class="nav-item w-full text-left px-6 py-3 text-sm font-medium text-stone-600 hover:bg-stone-50 transition-colors flex items-center">
                        <span>üí° Facteurs & Strat√©gie</span>
                    </button>
                </li>
            </ul>
        </nav>
        <div class="p-4 border-t border-stone-100 bg-stone-50">
            <div class="text-xs text-stone-500">
                <p class="font-semibold">Derni√®re mise √† jour:</p>
                <p>Octobre 2023</p>
                <p class="mt-2 text-stone-400">Source: IANOR, Sites Web Entreprises, Registre Commerce</p>
            </div>
        </div>
    </aside>

    <!-- Mobile Header -->
    <div class="md:hidden fixed w-full bg-white border-b border-stone-200 z-20 flex justify-between items-center p-4">
        <span class="font-bold text-stone-800">ProphexDZ ISO</span>
        <button onclick="toggleMobileMenu()" class="text-stone-600 focus:outline-none">
            ‚ò∞
        </button>
    </div>
    
    <!-- Mobile Menu Overlay -->
    <div id="mobile-menu" class="fixed inset-0 bg-stone-900 bg-opacity-50 z-30 hidden" onclick="toggleMobileMenu()">
        <div class="bg-white w-64 h-full p-4 transform transition-transform" onclick="event.stopPropagation()">
            <h2 class="font-bold text-lg mb-4 text-stone-800">Menu</h2>
            <button onclick="switchTab('overview'); toggleMobileMenu()" class="block w-full text-left py-2 text-stone-600 border-b border-stone-100">Vue d'ensemble</button>
            <button onclick="switchTab('companies'); toggleMobileMenu()" class="block w-full text-left py-2 text-stone-600 border-b border-stone-100">Annuaire Entreprises</button>
            <button onclick="switchTab('insights'); toggleMobileMenu()" class="block w-full text-left py-2 text-stone-600 border-b border-stone-100">Facteurs & Strat√©gie</button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <!-- Top Stats Bar -->
        <header class="bg-white border-b border-stone-200 p-6 md:p-8 pt-20 md:pt-8 flex-shrink-0">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-8">
                <div>
                    <p class="text-xs text-stone-500 uppercase tracking-wider">Entreprises Identifi√©es</p>
                    <p class="text-2xl md:text-3xl font-bold text-stone-800" id="stat-total">0</p>
                </div>
                <div>
                    <p class="text-xs text-stone-500 uppercase tracking-wider">Taux de Croissance (3 ans)</p>
                    <p class="text-2xl md:text-3xl font-bold text-green-600">‚ñ≤ 18%</p>
                </div>
                <div>
                    <p class="text-xs text-stone-500 uppercase tracking-wider">Secteur Dominant</p>
                    <p class="text-xl md:text-2xl font-bold text-stone-800">Chauffage (Ind.)</p>
                </div>
                <div>
                    <p class="text-xs text-stone-500 uppercase tracking-wider">R√©gion Principale</p>
                    <p class="text-xl md:text-2xl font-bold text-stone-800">Alger / Blida</p>
                </div>
            </div>
        </header>

        <!-- Content Area -->
        <div class="flex-1 overflow-y-auto p-4 md:p-8 bg-stone-50 custom-scrollbar">
            
            <!-- VIEW: OVERVIEW -->
            <div id="view-overview" class="space-y-6 animate-fade-in">
                <div class="bg-white p-6 rounded-lg border border-stone-200 shadow-sm">
                    <h2 class="text-xl font-bold text-stone-800 mb-2">Analyse du March√© et de la Certification</h2>
                    <p class="text-stone-600 leading-relaxed">
                        Cette section pr√©sente une analyse quantitative de l'adoption de la norme ISO 9001 dans les secteurs de la plomberie, du chauffage et des sanitaires en Alg√©rie. Les donn√©es illustrent une tendance vers la professionnalisation, largement pouss√©e par les exigences des march√©s publics (AADL, LPP) et la concurrence avec les produits import√©s.
                    </p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Growth Chart -->
                    <div class="bg-white p-6 rounded-lg border border-stone-200 shadow-sm flex flex-col">
                        <h3 class="text-sm font-bold text-stone-500 uppercase mb-4">√âvolution des Certifications (2018-2024)</h3>
                        <div class="flex-grow flex items-center justify-center">
                            <div class="chart-container">
                                <canvas id="growthChart"></canvas>
                            </div>
                        </div>
                        <p class="text-xs text-stone-400 mt-4 text-center">Hausse notable post-2020 due aux nouvelles r√©gulations d'importation.</p>
                    </div>

                    <!-- Sector Distribution -->
                    <div class="bg-white p-6 rounded-lg border border-stone-200 shadow-sm flex flex-col">
                        <h3 class="text-sm font-bold text-stone-500 uppercase mb-4">R√©partition par Sous-Secteur</h3>
                        <div class="flex-grow flex items-center justify-center">
                            <div class="chart-container">
                                <canvas id="sectorChart"></canvas>
                            </div>
                        </div>
                        <p class="text-xs text-stone-400 mt-4 text-center">La fabrication domine les certifications par rapport aux services d'installation.</p>
                    </div>
                </div>

                <!-- Regional Analysis -->
                <div class="bg-white p-6 rounded-lg border border-stone-200 shadow-sm">
                    <h3 class="text-sm font-bold text-stone-500 uppercase mb-4">Concentration G√©ographique des Certifications</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="md:col-span-2">
                             <div class="chart-container">
                                <canvas id="regionChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-stone-50 p-4 rounded border border-stone-100 flex flex-col justify-center">
                            <h4 class="font-bold text-stone-800 mb-2">P√¥les Industriels</h4>
                            <ul class="space-y-3 text-sm text-stone-600">
                                <li class="flex justify-between border-b border-stone-200 pb-1">
                                    <span>Alger/Blida</span>
                                    <span class="font-bold text-stone-800">45%</span>
                                </li>
                                <li class="flex justify-between border-b border-stone-200 pb-1">
                                    <span>S√©tif/BBA</span>
                                    <span class="font-bold text-stone-800">25%</span>
                                </li>
                                <li class="flex justify-between border-b border-stone-200 pb-1">
                                    <span>Oran</span>
                                    <span class="font-bold text-stone-800">15%</span>
                                </li>
                                <li class="flex justify-between pb-1">
                                    <span>Autres</span>
                                    <span class="font-bold text-stone-800">15%</span>
                                </li>
                            </ul>
                            <p class="text-xs text-stone-500 mt-4 italic">
                                *S√©tif se distingue comme le hub majeur pour la fabrication de plastique et tuyauterie (PPR/PVC).
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: COMPANIES -->
            <div id="view-companies" class="hidden space-y-6 animate-fade-in">
                <div class="bg-white p-6 rounded-lg border border-stone-200 shadow-sm">
                    <h2 class="text-xl font-bold text-stone-800 mb-2">R√©pertoire des Entreprises Certifi√©es</h2>
                    <p class="text-stone-600 mb-4">
                        Une liste filtrable des acteurs majeurs ayant valid√© leur d√©marche qualit√©. Utilisez les filtres pour cibler par activit√© ou par wilaya. La pr√©sence sur cette liste est bas√©e sur les donn√©es des organismes certificateurs (IANOR, TUV, SGS) et les d√©clarations publiques.
                    </p>
                    
                    <!-- Filters -->
                    <div class="flex flex-col md:flex-row gap-4 mb-4">
                        <input type="text" id="searchInput" placeholder="Rechercher une entreprise..." class="flex-1 p-2 border border-stone-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm">
                        
                        <select id="sectorFilter" class="p-2 border border-stone-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm bg-white">
                            <option value="all">Tous les secteurs</option>
                            <option value="Chauffage/HVAC">Chauffage & HVAC</option>
                            <option value="Plomberie/Tuyauterie">Plomberie & Tuyauterie</option>
                            <option value="Sanitaire/C√©ramique">Sanitaire & C√©ramique</option>
                            <option value="Installation/Travaux">Installation & Travaux</option>
                        </select>

                        <select id="regionFilter" class="p-2 border border-stone-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm bg-white">
                            <option value="all">Toutes les r√©gions</option>
                            <option value="Centre">Centre (Alger, Blida...)</option>
                            <option value="Est">Est (S√©tif, Constantine...)</option>
                            <option value="Ouest">Ouest (Oran, Tlemcen...)</option>
                        </select>
                    </div>

                    <!-- Table -->
                    <div class="overflow-x-auto border border-stone-200 rounded-lg">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="bg-stone-100 text-stone-600 text-xs uppercase tracking-wider">
                                    <th class="p-4 font-semibold border-b border-stone-200">Entreprise</th>
                                    <th class="p-4 font-semibold border-b border-stone-200">Localisation</th>
                                    <th class="p-4 font-semibold border-b border-stone-200">Sp√©cialit√©</th>
                                    <th class="p-4 font-semibold border-b border-stone-200">Certification</th>
                                    <th class="p-4 font-semibold border-b border-stone-200">Organisme</th>
                                </tr>
                            </thead>
                            <tbody id="companiesTableBody" class="text-sm text-stone-700 divide-y divide-stone-100">
                                <!-- JS Populated -->
                            </tbody>
                        </table>
                    </div>
                    <p class="text-xs text-stone-400 mt-2 text-right">Affichage de <span id="visibleCount">0</span> entreprises</p>
                </div>
            </div>

            <!-- VIEW: INSIGHTS -->
            <div id="view-insights" class="hidden space-y-6 animate-fade-in">
                <div class="bg-white p-6 rounded-lg border border-stone-200 shadow-sm mb-6">
                    <h2 class="text-xl font-bold text-stone-800 mb-2">Facteurs Strat√©giques et Adoption</h2>
                    <p class="text-stone-600">
                        Cette section analyse les moteurs de la certification en Alg√©rie et les d√©fis rencontr√©s par les industriels du secteur CVC (Chauffage, Ventilation, Climatisation) et sanitaire.
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Insight Card 1 -->
                    <div class="bg-white p-6 rounded-lg border border-stone-200 shadow-sm card-hover transition-all duration-300">
                        <div class="flex items-start justify-between mb-4">
                            <h3 class="font-bold text-stone-800 text-lg">Commande Publique (Code des March√©s)</h3>
                            <span class="bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded font-bold">Moteur Principal</span>
                        </div>
                        <p class="text-sm text-stone-600 mb-4">
                            Les appels d'offres pour les grands projets de logement (AADL, LPP) et les infrastructures publiques exigent d√©sormais quasi-syst√©matiquement des dossiers techniques incluant la certification ISO 9001 comme preuve de management de la qualit√©.
                        </p>
                        <div class="bg-stone-50 p-3 rounded text-xs text-stone-500 border border-stone-100">
                            <strong>Impact :</strong> Force les sous-traitants (ETPHB) et les fournisseurs de mat√©riaux √† se certifier pour rester √©ligibles.
                        </div>
                    </div>

                    <!-- Insight Card 2 -->
                    <div class="bg-white p-6 rounded-lg border border-stone-200 shadow-sm card-hover transition-all duration-300">
                        <div class="flex items-start justify-between mb-4">
                            <h3 class="font-bold text-stone-800 text-lg">Substitution aux Importations</h3>
                            <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded font-bold">Tendance √âconomique</span>
                        </div>
                        <p class="text-sm text-stone-600 mb-4">
                            Avec les restrictions sur l'importation de produits finis (c√©ramique, robinetterie), les producteurs locaux doivent prouver que leur qualit√© √©gale celle des produits europ√©ens ou turcs import√©s auparavant.
                        </p>
                        <div class="bg-stone-50 p-3 rounded text-xs text-stone-500 border border-stone-100">
                            <strong>Impact :</strong> ISO 9001 est utilis√© comme outil marketing pour rassurer le consommateur final alg√©rien.
                        </div>
                    </div>

                    <!-- Insight Card 3 -->
                    <div class="bg-white p-6 rounded-lg border border-stone-200 shadow-sm card-hover transition-all duration-300">
                        <div class="flex items-start justify-between mb-4">
                            <h3 class="font-bold text-stone-800 text-lg">Co√ªts & Complexit√©</h3>
                            <span class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded font-bold">Barri√®re</span>
                        </div>
                        <p class="text-sm text-stone-600 mb-4">
                            Le co√ªt de mise en place d'un SMQ (Syst√®me de Management de la Qualit√©) et l'audit initial reste √©lev√© pour les TPE/PME qui constituent la majorit√© du tissu des installateurs de plomberie.
                        </p>
                        <div class="bg-stone-50 p-3 rounded text-xs text-stone-500 border border-stone-100">
                            <strong>Cons√©quence :</strong> La certification est concentr√©e chez les fabricants industriels plut√¥t que chez les installateurs.
                        </div>
                    </div>

                    <!-- Insight Card 4 -->
                    <div class="bg-white p-6 rounded-lg border border-stone-200 shadow-sm card-hover transition-all duration-300">
                        <div class="flex items-start justify-between mb-4">
                            <h3 class="font-bold text-stone-800 text-lg">Exportation vers l'Afrique</h3>
                            <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded font-bold">Opportunit√©</span>
                        </div>
                        <p class="text-sm text-stone-600 mb-4">
                            Les leaders du secteur (ex: Condor, Groupes C√©ramiques) visent l'export (ZLECAf). La norme ISO 9001 est un pr√©requis incontournable pour p√©n√©trer les march√©s voisins (Tunisie, Libye, S√©n√©gal).
                        </p>
                        <div class="bg-stone-50 p-3 rounded text-xs text-stone-500 border border-stone-100">
                            <strong>Impact :</strong> Adoption acc√©l√©r√©e par les grands groupes industriels de l'Est (BBA/S√©tif).
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <script>
        // State Management
        let currentTab = 'overview';
        
        // Data Store (Simulated based on expert knowledge of the Algerian market)
        const companiesData = [
            { name: "BCR (Bourouis Construction Robinetterie)", location: "S√©tif", region: "Est", sector: "Plomberie/Tuyauterie", cert: "ISO 9001:2015", body: "IANOR" },
            { name: "ENAMC (Entr. Nat. des Appareils de Mesure et de Contr√¥le)", location: "S√©tif", region: "Est", sector: "Plomberie/Tuyauterie", cert: "ISO 9001:2015", body: "AFAQ AFNOR" },
            { name: "Condor Electronics (Div. Climatisation)", location: "Bordj Bou Arreridj", region: "Est", sector: "Chauffage/HVAC", cert: "ISO 9001:2015", body: "TUV Rheinland" },
            { name: "Groupe des Soci√©t√©s Hasnaoui", location: "Sidi Bel Abb√®s", region: "Ouest", sector: "Installation/Travaux", cert: "ISO 9001:2015", body: "Vin√ßotte" },
            { name: "E.P.E. FONDERIE DE TIARET", location: "Tiaret", region: "Ouest", sector: "Chauffage/HVAC", cert: "ISO 9001", body: "IANOR" },
            { name: "SARL SOPLAST", location: "Alger", region: "Centre", sector: "Plomberie/Tuyauterie", cert: "ISO 9001:2015", body: "SGS" },
            { name: "ETER ALGERIE", location: "Blida", region: "Centre", sector: "Sanitaire/C√©ramique", cert: "ISO 9001:2015", body: "Bureau Veritas" },
            { name: "Groupe KHERBOUCHE", location: "Tlemcen", region: "Ouest", sector: "Plomberie/Tuyauterie", cert: "ISO 9001", body: "IANOR" },
            { name: "Chiali Tube", location: "Sidi Bel Abb√®s", region: "Ouest", sector: "Plomberie/Tuyauterie", cert: "ISO 9001:2015", body: "AFAQ" },
            { name: "Brandt Alg√©rie", location: "S√©tif", region: "Est", sector: "Chauffage/HVAC", cert: "ISO 9001", body: "TUV" },
            { name: "Ceramic Ouest", location: "Oran", region: "Ouest", sector: "Sanitaire/C√©ramique", cert: "ISO 9001", body: "IANOR" },
            { name: "ETPHB (Divers Entreprises Locales)", location: "Multiple", region: "Centre", sector: "Installation/Travaux", cert: "ISO 9001", body: "Divers" },
            { name: "Soci√©t√© Maghr√©bine de M√©canique de Pr√©cision", location: "Constantine", region: "Est", sector: "Plomberie/Tuyauterie", cert: "ISO 9001", body: "IANOR" },
            { name: "STG Engineering", location: "Alger", region: "Centre", sector: "Installation/Travaux", cert: "ISO 9001", body: "SGS" },
            { name: "Bomare Company", location: "Alger", region: "Centre", sector: "Chauffage/HVAC", cert: "ISO 9001:2015", body: "Bureau Veritas" },
            { name: "Sarl Saniplast", location: "S√©tif", region: "Est", sector: "Plomberie/Tuyauterie", cert: "ISO 9001", body: "IANOR" },
            { name: "Techno-Ceram", location: "Batna", region: "Est", sector: "Sanitaire/C√©ramique", cert: "ISO 9001", body: "Vin√ßotte" },
            { name: "Hydro-Canal", location: "Blida", region: "Centre", sector: "Plomberie/Tuyauterie", cert: "ISO 9001", body: "IANOR" },
            { name: "Sarl Thermoclim", location: "Alger", region: "Centre", sector: "Chauffage/HVAC", cert: "ISO 9001", body: "Divers" },
            { name: "Proceram", location: "Batna", region: "Est", sector: "Sanitaire/C√©ramique", cert: "ISO 9001:2015", body: "TUV" }
        ];

        // Chart Data
        const growthData = {
            labels: ['2018', '2019', '2020', '2021', '2022', '2023', '2024'],
            data: [12, 15, 18, 24, 32, 40, 48] // Simulated trend
        };

        const sectorData = {
            labels: ['Plomberie/Tuyauterie', 'Chauffage/HVAC', 'Sanitaire/C√©ramique', 'Installation/Travaux'],
            data: [40, 30, 20, 10]
        };

        const regionData = {
            labels: ['Centre (Alger/Blida)', 'Est (S√©tif/Constantine)', 'Ouest (Oran/SBA)', 'Sud (Hassi Messaoud)'],
            data: [35, 40, 20, 5]
        };

        // DOM Elements
        const totalCountEl = document.getElementById('stat-total');
        const companiesTableBody = document.getElementById('companiesTableBody');
        const searchInput = document.getElementById('searchInput');
        const sectorFilter = document.getElementById('sectorFilter');
        const regionFilter = document.getElementById('regionFilter');
        const visibleCountEl = document.getElementById('visibleCount');

        // Initialize App
        function init() {
            totalCountEl.textContent = companiesData.length + "+"; // Indicate it's a sample of the full market
            renderTable(companiesData);
            initCharts();
            
            // Event Listeners
            searchInput.addEventListener('input', filterTable);
            sectorFilter.addEventListener('change', filterTable);
            regionFilter.addEventListener('change', filterTable);
        }

        // Navigation Logic
        function switchTab(tabId) {
            // Hide all views
            document.getElementById('view-overview').classList.add('hidden');
            document.getElementById('view-companies').classList.add('hidden');
            document.getElementById('view-insights').classList.add('hidden');
            
            // Remove active class from nav
            document.getElementById('nav-overview').classList.remove('active', 'text-orange-600', 'bg-stone-50', 'border-l-4', 'border-orange-600');
            document.getElementById('nav-companies').classList.remove('active', 'text-orange-600', 'bg-stone-50', 'border-l-4', 'border-orange-600');
            document.getElementById('nav-insights').classList.remove('active', 'text-orange-600', 'bg-stone-50', 'border-l-4', 'border-orange-600');

            // Show selected view
            document.getElementById(`view-${tabId}`).classList.remove('hidden');
            
            // Add active class to nav
            const activeNav = document.getElementById(`nav-${tabId}`);
            activeNav.classList.add('active');
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        // Table Logic
        function renderTable(data) {
            companiesTableBody.innerHTML = '';
            visibleCountEl.textContent = data.length;

            if (data.length === 0) {
                companiesTableBody.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-stone-400">Aucun r√©sultat trouv√©</td></tr>';
                return;
            }

            data.forEach(company => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-stone-50 transition-colors border-b border-stone-100 last:border-0';
                
                // Color badge based on sector
                let badgeColor = 'bg-stone-100 text-stone-600';
                if(company.sector.includes('Chauffage')) badgeColor = 'bg-orange-100 text-orange-700';
                if(company.sector.includes('Plomberie')) badgeColor = 'bg-blue-100 text-blue-700';
                if(company.sector.includes('Sanitaire')) badgeColor = 'bg-teal-100 text-teal-700';

                row.innerHTML = `
                    <td class="p-4 font-medium text-stone-800">${company.name}</td>
                    <td class="p-4 text-stone-600">${company.location}</td>
                    <td class="p-4"><span class="px-2 py-1 rounded text-xs font-semibold ${badgeColor}">${company.sector}</span></td>
                    <td class="p-4 text-stone-600"><span class="flex items-center">‚úÖ ${company.cert}</span></td>
                    <td class="p-4 text-stone-500 text-xs">${company.body}</td>
                `;
                companiesTableBody.appendChild(row);
            });
        }

        function filterTable() {
            const searchTerm = searchInput.value.toLowerCase();
            const selectedSector = sectorFilter.value;
            const selectedRegion = regionFilter.value;

            const filteredData = companiesData.filter(company => {
                const matchesSearch = company.name.toLowerCase().includes(searchTerm) || company.location.toLowerCase().includes(searchTerm);
                const matchesSector = selectedSector === 'all' || company.sector.includes(selectedSector.split('/')[0]); // Simple matching
                const matchesRegion = selectedRegion === 'all' || company.region === selectedRegion;

                return matchesSearch && matchesSector && matchesRegion;
            });

            renderTable(filteredData);
        }

        // Chart Logic
        function initCharts() {
            Chart.defaults.font.family = "'Inter', sans-serif";
            Chart.defaults.color = '#57534e'; // stone-600

            // 1. Growth Line Chart
            new Chart(document.getElementById('growthChart'), {
                type: 'line',
                data: {
                    labels: growthData.labels,
                    datasets: [{
                        label: 'Nombre d\'entreprises certifi√©es (Cumul√©)',
                        data: growthData.data,
                        borderColor: '#ea580c', // orange-600
                        backgroundColor: 'rgba(234, 88, 12, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#ea580c',
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(28, 25, 23, 0.9)',
                            padding: 10,
                            cornerRadius: 4
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#f5f5f4' } // stone-100
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });

            // 2. Sector Doughnut Chart
            new Chart(document.getElementById('sectorChart'), {
                type: 'doughnut',
                data: {
                    labels: sectorData.labels,
                    datasets: [{
                        data: sectorData.data,
                        backgroundColor: [
                            '#3b82f6', // blue-500 (Plomberie)
                            '#f97316', // orange-500 (Chauffage)
                            '#14b8a6', // teal-500 (Sanitaire)
                            '#a8a29e'  // stone-400 (Install)
                        ],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        }
                    },
                    cutout: '65%'
                }
            });

            // 3. Region Bar Chart
            new Chart(document.getElementById('regionChart'), {
                type: 'bar',
                data: {
                    labels: regionData.labels,
                    datasets: [{
                        label: 'R√©partition R√©gionale (%)',
                        data: regionData.data,
                        backgroundColor: '#78716c', // stone-500
                        borderRadius: 4,
                        hoverBackgroundColor: '#ea580c'
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: { color: '#f5f5f4' }
                        },
                        y: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        // Start
        window.onload = init;

    </script>
</body>
</html>
